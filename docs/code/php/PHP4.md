# 函数基本应用

> 目标：掌握函数的概念和作用，掌握模块化编程思想，理解函数的各个部分，能够自定义函数解决问题

* 函数的概念和应用
* 函数的基本结构
* 函数的定义规范

## 1、认识函数



> 目标：掌握函数的概念和作用



提问：如果有一个需求，会在不同的应用场景里都出现，那么怎么可以让代码可以多处使用呢？

回答：

1、复制粘贴：灵活性差，维护起来要多处维护

2、使用函数：一处维护，多处使用



> 举个栗子

![函数概念](/img/php/函数概念.gif)



1、买的东西可能变化

2、价格可能不同

3、买的时机不固定

4、但是买的过程每次都差一样

**所以**：以上完成买东西的过程，可以在需要用到的时候调取执行即可完成。



> 概念

**函数**：某段在一起解决某个问题的代码块，给代码块一个标识符，以后可以使用标识符来访问代码块

* 函数是由一堆代码块组成
* 函数会有一个函数标识（函数名）
* 函数能够在需要用到的时候通过名字直接让代码块运行
* 函数的作用
  * 模块化编程：业务拆分成小模块，然后使用函数进行代码编写
  * 代码的复用：通过调用函数实现函数代码块的重复利用
* 函数的基本结构
  * 关键字：function
  * 函数名：自定义的名字（代码块标志）
  * 参数：数据的改变（业务相同，数据可以不同）
  * 函数体：解决问题的代码块
  * return：返回值，函数运行的结果处理

```php
function 函数名(参数)
{
    函数体（代码块）
    return 返回值
}
```



> 示例

```php
# 买火腿
function getGoods(){
    #计算位置
    #计算距离
    #计算价格
    #计算时间
    return '火腿';
}

#写好上述代码后，凡是要买火腿的时候，都使用getGoods就可以了
```



> 小结

1、函数是一起解决某个问题的代码块，解决的问题是两个

* 模块化编程：一个函数就是一个模块的最小单元
* 代码的复用：函数代码可以在需要时重复利用

2、函数组成

* 关键字：function
* 函数名：函数使用的标志
* 参数：数据的动态改变，如果业务固定，那么可以没有参数
* 函数体：解决问题的代码块
* 返回值：函数处理完的结果处理，如果业务不需要返回值，可以没有



## 2、函数基本应用



> 目标：了解函数的定义规范和使用



> 概念

**函数应用**：是指根据需求定义函数，然后在需要的位置调用函数

* 定义函数
* 调用函数：使用函数名 + ()即可实现调用



> 步骤

1、分析需求功能

2、确定函数名

3、确定函数体

4、调用函数



> 示例

```php
#打印九九乘法表
#1、分析需求：打印九九乘法表，可能有多个位置需要使用（因此使用函数开发）

#2、确定函数名：九九乘法表，确定相关性
function chengfa99(){
    #3、确定函数体：输出（不需要返回值）
    for($i = 1;$i <= 9;$i++){
        for($j = 1;$j <= $i;$j++){
            echo "$j * $i = " . $j * $i  . ' ';
        }
        #换行
        echo '<br/>';
    }
}

#4、调用函数
chengfa99();
chengfa99();		#多次调用，不需要重复写99乘法表逻辑
```



> 小结

1、函数应用分为两个部分

* 定义函数：根据需求实现函数
* 调用函数：在需要函数运行的时候调用函数

2、函数一旦定义，可以无限次调用



## 3、函数内存分析



> 目标：了解函数在内存中的运行原理



> 概念

* 函数运行（调用）的前提：当前函数已经在内存中存在
* 函数不会自动运行
* 函数运行是在栈区开辟内存运行
* 函数运行结束会自动释放所占用内存



> 步骤

1、脚本编译：将代码加载到内存中

* 代码被读取（读到内存中：代码写在文件中）
* 代码被编译：语法出错会报错（结果是将编译后的代码装在到代码段（专门放代码的内存））
* 所有代码被加载到内存中

2、代码执行

* 代码顺序逐行执行
* 函数结构不会被执行（跳过）

3、函数执行（函数名+()）

* 在内存中寻找函数名对应的函数是否存在
  * 不存在：报错
  * 存在：继续
* 在栈区开辟内存加载函数
  * 参数处理
  * 函数体执行
* 函数执行结束
  * 占用内存释放（栈区内存）
  * 回到函数调用处

4、脚本执行结束：释放所有内存（包括存放代码的代码段）



> 示例

```php
#先调用函数
hello();
world();

#后定义函数
function hello(){
    echo 'hello';
}
```



结果分析：

1、代码编译：函数hello被加载到内存

2、执行代码

* hello()执行：发现内存中有：执行，输出hello
* world()执行：发现内存中没有：报错



> 小结

1、函数运行的前提是内存中已经存在该函数

2、函数运行与定义的顺序没有先后顺序（建议先定义后运行）

3、函数的执行是在栈区运行（效率高）

4、函数运行完就会释放自己所用到的内存

5、PHP脚本运行结束会释放所有内存



## 4、函数形参



> 目标：了解形参的概念和意义，灵活运用形参增加函数的灵活性



> 概念

**形参**：形式参数，指在函数定义结构时所使用到的占位符

* 形参在函数定义时设置的变量
* 形参设定后是在函数内部使用
* 形参名字与外部任何变量无关
* 形参数量根据具体的需求定，理论不限（不要太多）
* 形参作用
  * 在函数内部先使用对应的形参假设运算（允许外部调整运算数据）



> 步骤

1、确定函数需求

2、在定义函数时：确定是否需要形参参与内部运算以及需求数量

3、在函数内部利用形参实现运算



> 示例

1、打印不确定层级的乘法表

```php
#1、确定需求：打印乘法表，但是不确定层级
#2、不确定的层级无法完成，所以需要一个变量来控制，通过形参实现$n
function chengfaN($n){
    #3、内部利用$n来代替层级
    for($i = 1;$i <= $n;$i++){
        for($j = 1;$j <= $i;$j++){
            echo "$j * $i = " . $j * $i . ' ';
        }
        #换行
        echo '<br/>';
    }
}
```



2、求两个数的平方和

```php
#1、确定需求：两个数的平方和
#2、需要两个数不确定，利用形参代替
function mySum($n1,$n2){
    #3、内部利用$n1和$n2代表两个数
    echo $n1 ** 2 + $n2 ** 2;
}
```



> 小结

1、形参是在函数定义时指定的变量

2、形参的作用是在函数内部代替数据进行运行（占位符）

* 形参数量可以根据需求来确定

3、形参作用

* 允许内部数据产生变化（从而运算出不同结果）



## 5、函数实参



> 目标：了解实参的工作原理，以及实参与形参的关系



> 概念

**实参**：实际参数，指在调用函数数传递进去的实际数据

* 实参是在调用函数时传递的数据
* 实参数据可以是数据也可以是保存数据的其他表达式
  * 数据常量
  * 变量
  * 常量
  * 运算表达式
* 实参的本质是将数据赋值给形参
* 实参需要对准形参（数量、顺序）



> 步骤

1、确定函数的形参数量和顺序

2、在调用函数时传入相应的实参

* 数量对好
* 顺序对齐



> 示例

```php
#定义函数：形参
function mySum($n1,$n2){
    echo $n1 ** 2 + $n2 ** 2;
}

#1、确定形参数量和顺序：数量2个，顺序第一个是整数，第二个也是整数
#2、调用函数：传入实际参数（数据常量）
mySum(2,3);		#输出13

#调用函数：传入变量和常量
$var1 = 2;
const V = 3;
mySum($var1,V);	#13

#调用函数：传入运算结果
mySum(1+1,1+2);	#13
```



> 流程图分析

![函数流程图](/img/php/调用函数流程图.png)

> 小结

1、实参是在调用时传入的实际数据

* 数据常量
* 变量
* 常量
* 有结果的表达式

2、实参是在调用函数时将值赋值给形参，本质是形参拿到值之后在参与函数运算

3、实参的数量和顺序必须对应形参

* 数量少于形参，运行时形参得不到赋值，会报错
* 数量多于形参，不影响函数运行
* 顺序必须在调用时对应好，系统不能自动匹配



## 6、形参默认值



> 目标：掌握默认值的意义和应用场景，了解默认值的工作原理



> 概念

**形参默认值**：是指在定义形参的时候就给定一个大概率值，可以在调用时不传递

* 默认值在定义时赋值
* 默认值是最常见出现的值
* 默认值是在调用时才给形参赋值
* 有默认值后
  * 调用时不传递实参，系统自动给形参赋值默认值
  * 调用时传递实参，系统会使用实参而不是默认值



> 步骤

1、定义函数：给形参设定默认值

2、调用函数

* 传递实参，形参使用实参数据赋值
* 不传递实参，形参使用默认值赋值



> 示例

```php
#打印乘法表

#定义函数：乘法表打印最多就是九九乘法表，所以给定默认值
function chengfa($n = 9){
    for($i = 1;$i <= $n;$i++){
        for($j = 1;$j <= 1;$j++){
            echo "$j * $i = " . $j * $i . ' ';
        }
        echo '<br/>';
    }
}

#调用
chengfa();		#打印九九乘法表
chengfa(5);		#打印五五乘法表
```



> 小结

1、默认值是在定义函数时给形参设定的预计值

2、默认值设定的通常是参数最可能出现的值

3、默认值的设定目的

* 让函数能够在不传递实参也能正常工作（便捷性）
* 允许调用者通过数据改变函数计算结果（灵活性）

4、默认值是在函数调用的时候赋值

* 调用时没有传递实参：使用默认值赋值给形参
* 调用时有传递实参：使用实参赋值给形参



## 7、参数传值方式



> 目标：了解参数传值方式的区别和应用



> 概念

**参数传值方式**：在函数调用时，实参给形参传值时所采用的传值方式

* 参数传值方式在函数定义时规定
* 参数传值方式有两种
  * 值传递：默认，即外部数据，如function a($b)
  * 引用传递：使用&符号，即传递外部变量存储数据的内存地址，如function a(&$b)



> 步骤

1、确定函数参数的目的

* 外部传入数据内部运算，不影响外部：值传递
* 外部传入数据内部运算，同时外部也受影响：引用传递

2、传递实参时要确定形参的传值方式

* 值传递：数据常量、变量、常量、运算表达式都可以（能有数据都可以）
* 引用传递：变量



> 示例

```PHP
#值传递：输出一个指定数到1之间的整数
function display1($n){
    while($n > 1){
        echo $n--;	#当前$n最终会等于0（正常正数传入）
    }
}

$a = 3;
display1($a);		#输出3,2,1
display1(2);		#输出2,1
echo $a;			#3，没有变化

#引用传递：输出一个指定数到1之间的整数（改变传入的数据）
function display2(&$m){
   while($n > 1){
        echo $n--;	#当前$n最终会等于0（正常正数传入）
    } 
}

$b = 3;
display2($b);		#输出3,2,1
echo $b;			#输出0
display2(2);		#报错：形参$m要求引用传值，只能传入变量
```



> 小结

1、参数传值方式是指实参传入到形参后，内部的改变是否对外部有影响

* 值传递：传递数值，内部修改不影响外部（所以外部只要是能得到数据的方式都可以做实参）
* 引用传递：传递数据的内存地址，内部修改影响外部（所以只能传递变量）



## 8、返回值



> 目标：掌握返回值的操作，了解return关键字的作用



> 概念

**返回值**：即函数运行过程中对调用处返回的处理结果

* 关键字：return
* 函数都有返回值
  * 默认返回null
  * 可以明确使用return返回任意数据类型
* return会强制结束函数



> 步骤

1、确定函数功能：是否需要运算结果

* 不需要：不用管返回值
* 需要：在得到结果后将结果返回

2、函数是否需要终止运行，需要的话：直接return

3、在函数调用处对结果进行操作

* 输出结果
* 使用变量保存结果



> 示例

1、默认返回值

```php
function display1(){
    echo __FUNCTION__;
}
$res = display1();		#display1
var_dump($res);			#null

```



2、使用返回值

```php
function display2(){
    return __FUNCTION__;
}
$res = display2();
var_dump($res);			#display2
```



3、使用return结束函数

```php
function display3(){
    return __FUNCTION__;
    echo 'hello world';
}
$res = display3();		#不会输出：return让函数结束了
var_dump($res);			#display3
```



> 小结

1、函数使用return返回内部结果

* 默认函数最后会自动返回null
* return可以返回任意类型的数据

2、return返回值是返回给函数调用处

3、return一旦运行，之后的其他函数体就不会执行了



## 9、函数规则



> 目标：了解函数的基本使用规则，并按照规则来实现开发



> 概念

**函数规则**：函数本身没有太多规则，通常是我们开发者对其有一些约定俗称的规范



1、函数命名规则

* 函数名字由数字、字母和下划线组成，数字不能开头
* PHP中函数名不区分大小写
* PHP中函数名不能重复：即一个脚本运行周期内不能有两个同名函数
* 函数命名应当见名知意
* 当函数有多个单词组成的时候，通常使用以下两种方式
  * 驼峰法：第一个单词首字母小写，其他单词首字母大写（小驼峰）
  * 下划线法：都小写，但是单词间使用下划线连接（较多使用）

2、函数运用规则

* 函数的目的是为了模块化开发，实现代码的重复利用
* 函数解决问题的颗粒度较小：即函数应该实现小功能（不贪大，越小复用性越高，大问题可以是由多个小函数组成，调用即可）

3、函数体规则

* 函数体主要是用来解决某个具体问题
* 函数体可以进行定义变量、运算数据、数据判定（分支）、数据重复（循环），也可以通过调用其他函数解决问题
* 函数体内基本不进行输出操作，如果有数据的话通常是通过返回值返回给调用处

* 函数操作通常只负责运算，不对结果负责（即结果交给调用处分析判定）
